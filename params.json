{"name":"pcarrier:connstats","tagline":"Hits and DDP monitoring for Meteor apps","body":"# `pcarrier:connstats`: hits and DDP monitoring for Meteor apps\r\n\r\n## Installing\r\n\r\nFrom your Meteor app, run:\r\n\r\n    $ meteor add pcarrier:connstats\r\n\r\n## Interface\r\n\r\n`pcarrier:connstats` exposes monitoring information about hits and DDP connections\r\nas JSON over `/.well-known/pcarrier/connstats`.\r\n\r\nWhenever an error occurs, it will set an appropriate status code and respond with a JSON object\r\nwhose only property is `\"error\"`.\r\n\r\nFor example, if a secret is set in the Meteor settings but was not passed in the query string as\r\n`?secret=[...]`, it will respond with the status code 403 and the object:\r\n\r\n    {\"error\":\"secret needed\"}\r\n\r\nIf no error occured, it returns a JSON document following this format:\r\n\r\n    {\r\n      \"hitSamples\": [\r\n        {\r\n          \"ua\": \"curl/7.43.0\",\r\n          \"ip\": \"192.0.2.1\",\r\n          \"host\": \"example.com\",\r\n          \"url\": \"/hello?world\",\r\n          \"ts\": \"2016-01-01T00:00:00.000Z\"\r\n        },\r\n        ...\r\n      ],\r\n      \"activeSessions\": [\r\n        {\r\n          \"ua\": \"curl/7.43.0\",\r\n          \"ip\": \"192.0.2.1\",\r\n          \"started\": \"2016-01-01T00:00:00.000Z\"\r\n        },\r\n        ...\r\n      ],\r\n      \"startedSessions\": [\r\n        {\r\n          \"ua\": \"curl/7.43.0\",\r\n          \"ip\": \"192.0.2.1\",\r\n          \"started\": \"2016-01-01T00:00:00.000Z\"\r\n        },\r\n        ...\r\n      ],\r\n      \"endedSessions\": [\r\n        {\r\n          \"ua\": \"curl/7.43.0\",\r\n          \"ip\": \"192.0.2.2\",\r\n          \"started\": \"2016-01-01T00:00:01.000Z\",\r\n          \"ended\":   \"2016-01-01T00:00:02.000Z\"\r\n        },\r\n        ...\r\n      ]\r\n    }\r\n\r\nThis format is specified in [schema.json](schema.json),\r\nwhich follows the IETF draft [draft-zyp-json-schema-04](https://tools.ietf.org/html/draft-zyp-json-schema-04).\r\n\r\n`hitSamples` tracks all HTTP and WebSocket requests.\r\nIt uses random replacement, so arbitrarily old hits can be found in the samples\r\nbut recent hits are more likely to be exposed than older hits.\r\n\r\n## Settings\r\n\r\n    Meteor.settings.connstats = {\r\n      trackHosts:      false, // track the Host: header in hitSamples; disabled by default\r\n      trackURLs:       false, // track URLs in hitSamples; disabled by default\r\n      hitSamples:      256,   // how many requests should be kept in the sample\r\n      startedSessions: 64,    // retain the last n started sessions\r\n      endedSessions:   64,    // retain the last n ended sessions\r\n      secret: undefined       // a secret that needs to be passed in the query string; disabled by default\r\n    }\r\n\r\n## Notes\r\n\r\n- The `ip` field is determined by reading the first field of the comma-separated `X-Forwarded-For` header.\r\nThis will break if Meteor is not behind a proxy respecting\r\n[the semantics of this non-standard but widely agreed-upon header](https://en.wikipedia.org/wiki/X-Forwarded-For).\r\n\r\n- This package abuses the `/.well-known/` prefix from [RFC-5785](https://tools.ietf.org/html/rfc5785#section-3)\r\n  as we have not gone through the registration process yet.\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}